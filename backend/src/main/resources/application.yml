# ════════════════════════════════════════════════
# HiveApp Platform — Base Configuration
# ════════════════════════════════════════════════

spring:
  application:
    name: hiveapp-platform

  # ── JPA / Hibernate ──────────────────────────
  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        format_sql: true
        default_schema: public
        jdbc:
          time_zone: UTC
          batch_size: 25
        order_inserts: true
        order_updates: true
        generate_statistics: false

  # ── Flyway ───────────────────────────────────
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    validate-on-migrate: true

  # ── Jackson ──────────────────────────────────
  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false
      fail-on-empty-beans: false
    deserialization:
      fail-on-unknown-properties: false

  # ── Cache ────────────────────────────────────
  cache:
    type: redis
    redis:
      time-to-live: 3600000
      cache-null-values: false

# ── Server ───────────────────────────────────
server:
  port: 8080
  servlet:
    context-path: /api
  error:
    include-message: never
    include-binding-errors: never
    include-stacktrace: never

# ── Actuator ─────────────────────────────────
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,modulith,caches
      base-path: /management
  endpoint:
    health:
      show-details: when-authorized
      probes:
        enabled: true
  info:
    env:
      enabled: true

# ── OpenAPI / Swagger ────────────────────────
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha

# ── HiveApp Custom Properties ────────────────
hiveapp:
  jwt:
    secret: ${HIVEAPP_JWT_SECRET:default-dev-secret-change-in-production-must-be-at-least-64-characters-long-for-hs512}
    access-token-expiration: 900000       # 15 minutes
    refresh-token-expiration: 604800000   # 7 days
    issuer: hiveapp-platform
  security:
    cors:
      allowed-origins: http://localhost:3000,http://localhost:4200
      allowed-methods: GET,POST,PUT,PATCH,DELETE,OPTIONS
      allowed-headers: "*"
      max-age: 3600
  permission:
    cache:
      ttl: 300000                          # 5 minutes
      max-size: 10000
